{"ast":null,"code":"import { GoogleSpreadsheet } from 'google-spreadsheet';\nimport moment from 'moment';\nimport credentials from '../../credentials.json';\nconst doc = new GoogleSpreadsheet('1GN7Y73p6bvDEbo44JeaquRiClTTE4HwkrboAY8ImI3w');\nexport default (async (req, res) => {\n  try {\n    await doc.useServiceAccountAuth(credentials);\n    await doc.loadInfo();\n    console.log(doc.title);\n    const sheet = doc.sheetsByIndex[1];\n    const data = JSON.parse(req.body);\n    const sheetConfig = doc.sheetsByIndex[2];\n    await sheetConfig.loadCells('A2:B2');\n    const mostrarPromocaoCell = sheetConfig.getCell(1, 0);\n    const textoCell = sheetConfig.getCell(1, 1);\n    let Cupom = '';\n    let Promo = '';\n\n    if (mostrarPromocaoCell.value === 'VERDADEIRO') {\n      //TODO: GERAR CUPOM\n      Cupom = 'temporario';\n      Promo = textoCell.value;\n    } //Nome Email Whatsapp Cupom Promo\n\n\n    await sheet.addRow({\n      Nome: data.Nome,\n      Email: data.Email,\n      Whatsapp: data.Whatsapp,\n      'Data Preenchimento': moment().format('MMMM Do YYYY, h:mm:ss a'),\n      Cupom,\n      Promo\n    });\n    res.end(req.body);\n  } catch (err) {\n    console.log(err);\n    res.end('error');\n  }\n});","map":{"version":3,"sources":["C:/Users/dikvi/Desktop/meconta/pages/api/save.js"],"names":["GoogleSpreadsheet","moment","credentials","doc","req","res","useServiceAccountAuth","loadInfo","console","log","title","sheet","sheetsByIndex","data","JSON","parse","body","sheetConfig","loadCells","mostrarPromocaoCell","getCell","textoCell","Cupom","Promo","value","addRow","Nome","Email","Whatsapp","format","end","err"],"mappings":"AAAA,SAASA,iBAAT,QAAiC,oBAAjC;AACA,OAAOC,MAAP,MAAmB,QAAnB;AAEA,OAAOC,WAAP,MAAwB,wBAAxB;AAEA,MAAMC,GAAG,GAAG,IAAIH,iBAAJ,CAAsB,8CAAtB,CAAZ;AAEA,gBAAe,OAAMI,GAAN,EAAWC,GAAX,KAAkB;AAC7B,MAAG;AACC,UAAMF,GAAG,CAACG,qBAAJ,CAA0BJ,WAA1B,CAAN;AACA,UAAMC,GAAG,CAACI,QAAJ,EAAN;AACAC,IAAAA,OAAO,CAACC,GAAR,CAAYN,GAAG,CAACO,KAAhB;AACA,UAAMC,KAAK,GAAGR,GAAG,CAACS,aAAJ,CAAkB,CAAlB,CAAd;AACA,UAAMC,IAAI,GAAGC,IAAI,CAACC,KAAL,CAAWX,GAAG,CAACY,IAAf,CAAb;AAEA,UAAMC,WAAW,GAAGd,GAAG,CAACS,aAAJ,CAAkB,CAAlB,CAApB;AACA,UAAMK,WAAW,CAACC,SAAZ,CAAsB,OAAtB,CAAN;AAEA,UAAMC,mBAAmB,GAAGF,WAAW,CAACG,OAAZ,CAAoB,CAApB,EAAuB,CAAvB,CAA5B;AACA,UAAMC,SAAS,GAAGJ,WAAW,CAACG,OAAZ,CAAoB,CAApB,EAAuB,CAAvB,CAAlB;AAEA,QAAIE,KAAK,GAAG,EAAZ;AACA,QAAIC,KAAK,GAAG,EAAZ;;AACA,QAAGJ,mBAAmB,CAACK,KAApB,KAA8B,YAAjC,EAA8C;AAC3C;AACAF,MAAAA,KAAK,GAAG,YAAR;AACAC,MAAAA,KAAK,GAAGF,SAAS,CAACG,KAAlB;AACF,KAnBF,CAqBC;;;AACA,UAAMb,KAAK,CAACc,MAAN,CAAa;AACfC,MAAAA,IAAI,EAAEb,IAAI,CAACa,IADI;AAEfC,MAAAA,KAAK,EAAEd,IAAI,CAACc,KAFG;AAGfC,MAAAA,QAAQ,EAAEf,IAAI,CAACe,QAHA;AAIf,4BAAsB3B,MAAM,GAAG4B,MAAT,CAAgB,yBAAhB,CAJP;AAKfP,MAAAA,KALe;AAMfC,MAAAA;AANe,KAAb,CAAN;AAQElB,IAAAA,GAAG,CAACyB,GAAJ,CAAQ1B,GAAG,CAACY,IAAZ;AACD,GA/BL,CA+BK,OAAOe,GAAP,EAAY;AACTvB,IAAAA,OAAO,CAACC,GAAR,CAAYsB,GAAZ;AACA1B,IAAAA,GAAG,CAACyB,GAAJ,CAAQ,OAAR;AACH;AACR,CApCD","sourcesContent":["import { GoogleSpreadsheet } from'google-spreadsheet'\r\nimport moment from 'moment'\r\n\r\nimport credentials from '../../credentials.json'\r\n\r\nconst doc = new GoogleSpreadsheet('1GN7Y73p6bvDEbo44JeaquRiClTTE4HwkrboAY8ImI3w')\r\n\r\nexport default async(req, res) =>{\r\n    try{\r\n        await doc.useServiceAccountAuth(credentials)\r\n        await doc.loadInfo()\r\n        console.log(doc.title)\r\n        const sheet = doc.sheetsByIndex[1]\r\n        const data = JSON.parse(req.body)\r\n\r\n        const sheetConfig = doc.sheetsByIndex[2]\r\n        await sheetConfig.loadCells('A2:B2')\r\n\r\n        const mostrarPromocaoCell = sheetConfig.getCell(1, 0)\r\n        const textoCell = sheetConfig.getCell(1, 1)\r\n\r\n        let Cupom = ''\r\n        let Promo = ''\r\n        if(mostrarPromocaoCell.value === 'VERDADEIRO'){\r\n           //TODO: GERAR CUPOM\r\n           Cupom = 'temporario'\r\n           Promo = textoCell.value \r\n        }\r\n\r\n        //Nome Email Whatsapp Cupom Promo\r\n        await sheet.addRow({\r\n            Nome: data.Nome,\r\n            Email: data.Email,\r\n            Whatsapp: data.Whatsapp,\r\n            'Data Preenchimento': moment().format('MMMM Do YYYY, h:mm:ss a'),\r\n            Cupom,\r\n            Promo\r\n        })\r\n          res.end(req.body)\r\n        }catch (err) {\r\n            console.log(err)\r\n            res.end('error')\r\n        }\r\n}"]},"metadata":{},"sourceType":"module"}