{"ast":null,"code":"import { GoogleSpreadsheet } from 'google-spreadsheet';\nimport credentials from '../../credentials.json';\nconst doc = new GoogleSpreadsheet('1GN7Y73p6bvDEbo44JeaquRiClTTE4HwkrboAY8ImI3w');\nexport default (async (req, res) => {\n  try {\n    await doc.useServiceAccountAuth(credentials);\n    await doc.loadInfo();\n    const sheet = doc.sheetsByIndex[2];\n    await sheet.loadCells('A2:B2'); //Essa linha aqui voce vai pegar as informacoes das colunas da planilha. Nesse caso peguei a coluna A2 e B2\n\n    const mostrarPromocaoCell = sheet.getCell(1, 0); // Aqui estou pegando da planilha a linha 1 coluna 0\n\n    const textoCell = sheet.getCell(1, 1); // Aqui estou pegando da planilha a linha 1 coluna 1 o Texto da promocao\n\n    res.end(JSON.stringify({\n      showCoupon: mostrarPromocaoCell.value === 'VERDADEIRO',\n      message: textoCell.value\n    }));\n  } catch (err) {\n    res.end(JSON.stringify({\n      showCoupon: false,\n      message: ''\n    }));\n  }\n});","map":{"version":3,"sources":["C:/Users/dikvi/Desktop/meconta/pages/api/get-promo.js"],"names":["GoogleSpreadsheet","credentials","doc","req","res","useServiceAccountAuth","loadInfo","sheet","sheetsByIndex","loadCells","mostrarPromocaoCell","getCell","textoCell","end","JSON","stringify","showCoupon","value","message","err"],"mappings":"AAAA,SAASA,iBAAT,QAAiC,oBAAjC;AAEA,OAAOC,WAAP,MAAwB,wBAAxB;AAEA,MAAMC,GAAG,GAAG,IAAIF,iBAAJ,CAAsB,8CAAtB,CAAZ;AAGA,gBAAe,OAAMG,GAAN,EAAWC,GAAX,KAAmB;AAE9B,MAAG;AACC,UAAMF,GAAG,CAACG,qBAAJ,CAA0BJ,WAA1B,CAAN;AACA,UAAMC,GAAG,CAACI,QAAJ,EAAN;AAEA,UAAMC,KAAK,GAAGL,GAAG,CAACM,aAAJ,CAAkB,CAAlB,CAAd;AACA,UAAMD,KAAK,CAACE,SAAN,CAAgB,OAAhB,CAAN,CALD,CAK+B;;AAE9B,UAAMC,mBAAmB,GAAGH,KAAK,CAACI,OAAN,CAAc,CAAd,EAAiB,CAAjB,CAA5B,CAPD,CAOgD;;AAE/C,UAAMC,SAAS,GAAGL,KAAK,CAACI,OAAN,CAAc,CAAd,EAAiB,CAAjB,CAAlB,CATD,CASsC;;AAErCP,IAAAA,GAAG,CAACS,GAAJ,CAAQC,IAAI,CAACC,SAAL,CAAe;AACnBC,MAAAA,UAAU,EAAEN,mBAAmB,CAACO,KAApB,KAA8B,YADvB;AAEnBC,MAAAA,OAAO,EAAEN,SAAS,CAACK;AAFA,KAAf,CAAR;AAKC,GAhBL,CAgBM,OAAOE,GAAP,EAAY;AACVf,IAAAA,GAAG,CAACS,GAAJ,CAAQC,IAAI,CAACC,SAAL,CAAe;AACnBC,MAAAA,UAAU,EAAE,KADO;AAEnBE,MAAAA,OAAO,EAAC;AAFW,KAAf,CAAR;AAIP;AAEJ,CAzBD","sourcesContent":["import { GoogleSpreadsheet } from'google-spreadsheet'\r\n\r\nimport credentials from '../../credentials.json'\r\n\r\nconst doc = new GoogleSpreadsheet('1GN7Y73p6bvDEbo44JeaquRiClTTE4HwkrboAY8ImI3w')\r\n\r\n\r\nexport default async(req, res) => {\r\n   \r\n    try{\r\n        await doc.useServiceAccountAuth(credentials)\r\n        await doc.loadInfo()\r\n        \r\n        const sheet = doc.sheetsByIndex[2]\r\n        await sheet.loadCells('A2:B2')//Essa linha aqui voce vai pegar as informacoes das colunas da planilha. Nesse caso peguei a coluna A2 e B2\r\n        \r\n        const mostrarPromocaoCell = sheet.getCell(1, 0)// Aqui estou pegando da planilha a linha 1 coluna 0\r\n        \r\n        const textoCell = sheet.getCell(1, 1)// Aqui estou pegando da planilha a linha 1 coluna 1 o Texto da promocao\r\n        \r\n        res.end(JSON.stringify({\r\n            showCoupon: mostrarPromocaoCell.value === 'VERDADEIRO' ,\r\n            message: textoCell.value\r\n        }))\r\n    \r\n        } catch (err) {\r\n            res.end(JSON.stringify({\r\n                showCoupon: false,\r\n                message:''\r\n        }))\r\n    }\r\n\r\n}"]},"metadata":{},"sourceType":"module"}